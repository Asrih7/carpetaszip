{"version":3,"file":"src_app_pages_notifications_notifications_module_ts.js","mappings":"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","sources":["./src/app/pages/notifications/notifications-routing.module.ts","./src/app/pages/notifications/notifications.module.ts","./src/app/pages/notifications/notifications.page.html","./src/app/pages/notifications/notifications.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { NotificationsPage } from './notifications.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: NotificationsPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class NotificationsPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { NotificationsPageRoutingModule } from './notifications-routing.module';\n\nimport { NotificationsPage } from './notifications.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    NotificationsPageRoutingModule\n  ],\n  declarations: [NotificationsPage]\n})\nexport class NotificationsPageModule {}\n","<ion-header>\n  <ion-toolbar class=\"ion-text-center\" color=\"primary\">\n    <ion-title>Notificaciones</ion-title>\n    <ion-buttons slot=\"start\">\n      <ion-back-button text=\"Volver\"></ion-back-button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content fullscreen>\n  <ion-searchbar id=\"input\" (ionInput)=\"getItems($event)\" placeholder=\"Buscar por asunto\"></ion-searchbar>  \n  <ion-card *ngFor=\"let item of items; let i = index\" button=\"true\" (click)=\"leerNotificacion(items[i])\">\n    <ion-card-header>\n      <!-- <ion-icon class=\"ion-text-right\" name=\"time-outline\" [ngClass]=\"items[i].Reciente == true ? 'reciente' : 'normal' \"></ion-icon> -->\n      <ion-card-subtitle [ngClass]=\"items[i].Reciente == true ? 'reciente' : 'normal' \">\n        <ion-icon name=\"time-outline\" [ngClass]=\"items[i].Reciente == true ? 'reciente' : 'normal' \"></ion-icon> \n        {{items[i].FechaEnvio}}\n      </ion-card-subtitle>\n      <!-- <ion-card-title>{{items[i].Autor}}</ion-card-title> -->\n    </ion-card-header>\n    <!-- <ion-item>\n      <ion-avatar item-start>\n        <img src=\"../assets/imgs/icon.png\">\n        <ion-icon name=\"md-notifications\"></ion-icon>\n      </ion-avatar>      \n      <h3>{{items[i].Autor}}</h3>\n      <p><ion-icon small name=\"time-outline\" [ngClass]=\"items[i].Reciente == true ? 'reciente' : 'normal' \"></ion-icon> {{items[i].FechaEnvio}}</p>\n    </ion-item> -->\n  \n    <!-- <img src=\"img/advance-card-bttf.png\"> -->\n  \n    <ion-card-content class=\"ion-text-wrap\">\n      <h3><b>{{items[i].Asunto}}</b></h3>\n      <!-- <p>{{items[i].Comentario}}</p> -->\n      <!-- <div class=\"notificacion\" [innerHTML]=\"items[i].Autor | safeHtml\"></div> -->\n    </ion-card-content>\n  \n    <ion-row>\n      <ion-col>\n        <ion-button size=\"small\" fill=\"clear\" icon-start (click)=\"leerNotificacion(items[i])\">\n          <ion-icon *ngIf=\"items[i].Reciente == true\" name=\"notifications\"></ion-icon>\n          <ion-icon *ngIf=\"items[i].Reciente == false\" name=\"notifications-outline\"></ion-icon>\n        </ion-button>\n      </ion-col>\n      <ion-col class=\"ion-text-right\">\n        <ion-note>\n          <ion-button size=\"small\" icon-start (click)=\"leerNotificacion(items[i])\">\n              <ion-icon name='eye'></ion-icon>\n              Leer\n          </ion-button> \n        </ion-note>\n      </ion-col>\n    </ion-row>    \n\n  </ion-card>  \n  <section class=\"ion-padding ion-text-center\" *ngIf=\"items != null && items.length < 1\">\n    <img width=\"200\" src=\"../assets/imgs/empty.png\">\n  </section>\n  \n</ion-content>\n","import { Component, OnInit } from '@angular/core';\nimport { AlertController, LoadingController } from '@ionic/angular';\nimport { Router } from '@angular/router';\nimport { NavparamService } from 'src/app/services/navparam.service';\nimport { AulavirtualrestProvider } from '../../providers/aulavirtualrest';\nimport { LogoutProvider } from '../../providers/logout';\nimport { Storage } from '@ionic/storage-angular';\n\n@Component({\n  selector: 'app-notifications',\n  templateUrl: './notifications.page.html',\n  styleUrls: ['./notifications.page.scss'],\n})\nexport class NotificationsPage implements OnInit {\n\n  idCurso: number;\n  usuario: any = [];\n  items: any[];\n  allitems: any[];\n  titulo: string;\n  notificacion: string;\n  searchQuery: string = '';\n\n  constructor(private router: Router, private navParamService: NavparamService, public proveedor: AulavirtualrestProvider, public proveedorLogout: LogoutProvider, public alertCtrl: AlertController, public loadingCtrl: LoadingController, private storage: Storage) { }\n\n  ngOnInit() {\n  }\n\n  ionViewWillEnter() {\n\n    this.initialize();\n\n    // if (this.searchQuery == ''){\n    //   this.initializeItems();\n    // }\n  }\n\n  initialize() {\n\n    // Se cargan las notificaciones\n    if (this.searchQuery == ''){\n      this.initializeItems();\n    }\n  }\n\n  async initializeItems() {\n\n    const loading = await this.loadingCtrl.create({\n      message: \"Cargando...\"\n    });\n    await loading.present();\n\n    // Se obtienen el id del curso de la memoria\n    this.storage.get('idCurso').then((val) => {\n      if (val != null && val != undefined){\n        this.idCurso = val;       \n      }\n      else{\n        // Si no se han recuperado los datos se vuelve a la página de login\n        //this.logout();\n        this.proveedorLogout.logout();\n      }\n    });\n\n    // Se obtienen los datos del usuario de la memoria\n    this.storage.get('usuario').then((val) => {\n      if (val != null && val != undefined){\n        this.usuario = JSON.parse(val);\n\n        //console.log(this.idCurso);\n\n        this.proveedor.consultarNotificaciones(this.usuario.Mensaje.AuthorizationToken, this.idCurso)\n        .subscribe(\n          //(data)=>{this.tests = data;},\n          (data)=>{this.parseJson(data);},\n          (error)=>{console.log(error);},\n          () =>{loading.dismiss()}\n        )\n      }\n      else{\n        // Si no se han recuperado los datos se vuelve a la página de login\n        //this.logout();\n        this.proveedorLogout.logout();\n      }\n    });\n  }\n\n  parseJson(data)\n  {\n    //console.log(data);\n\n    if (data.Error == 0){\n      let jsonArray = data.Mensaje;\n\n      this.items = [];\n      this.allitems = [];\n\n      if (jsonArray.length > 0){\n        for(let i=0; i < jsonArray.length; i++)\n        {\n          let jsonObject = jsonArray[i];\n          this.items.push(jsonObject);\n          this.allitems.push(jsonObject);\n        }\n      }\n      else{\n        // const alert = this.alertCtrl.create({\n        //   this.Alert('Sin Notificaciones', 'No hay ninguna notificación publicada en tu curso.'); \n        //   title: 'Sin Notificaciones',\n        //   subTitle: 'No hay ninguna notificación publicada en tu curso.',\n        //   buttons: ['OK']\n        // });\n        // alert.present();\n        //this.sinNotificacionesAlert();\n      }\n    }\n    // Acceso denegado\n    else if (data.Error == -10){\n      //this.logout();\n      this.proveedorLogout.logout();\n    }\n    else{\n      this.items = [];\n      // const alert = this.alertCtrl.create({\n      //   title: 'Sin Notificaciones',\n      //   subTitle: 'No hay ninguna notificación publicada en tu curso.',\n      //   buttons: ['OK']\n      // });\n      // alert.present();\n      //this.sinNotificacionesAlert();\n    }\n  }\n\n  getItems(ev: any) {\n\n    if (this.allitems != null && this.allitems != undefined){\n      // Reset items back to all of the items\n      this.items = this.allitems;\n\n      this.searchQuery = '';\n\n      // set val to the value of the searchbar\n      const val = ev.target.value;\n\n      // if the value is an empty string don't filter the items\n      if (val && val.trim() != '') {\n        this.searchQuery = val;\n        this.items = this.items.filter((item) => {\n          //return ((item.Asunto.toLowerCase().indexOf(val.toLowerCase()) > -1) || (item.Autor.toLowerCase().indexOf(val.toLowerCase()) > -1));\n          return ((item.Asunto.toLowerCase().indexOf(val.toLowerCase()) > -1));\n        })\n      }\n    }\n  }\n\n  leerNotificacion(notificacion: any){\n    //console.log(notificacion);\n    //this.navCtrl.push(NotificationDetailPage, {notificacion: notificacion});\n    //this.router.navigateByUrl('notification-detail/(notificacion:/${notificacion})');    \n    //this.router.navigate(['/notification-detail', {notificacion: notificacion}]);\n    this.navParamService.setNavData(notificacion);\n    this.router.navigate(['/notification-detail']);\n  }\n\n  // logout()\n  // {\n  //   // const root = this.app.getRootNav();\n  //   // root.popToRoot();\n  //   this.proveedorLogout.logout();\n  //   //this.navCtrl.setRoot(LoginPage);\n  //   this.router.navigate(['/login']);\n  // }\n\n  async sinNotificacionesAlert() {\n    const alert = await this.alertCtrl.create({\n      header: 'Sin Notificaciones',\n      message: 'No hay ninguna notificación publicada en tu curso.',\n      buttons: ['OK']\n    });\n    await alert.present();\n  }\n\n}\n"],"names":["i0","NotificationsPage","constructor","router","navParamService","proveedor","proveedorLogout","alertCtrl","loadingCtrl","storage","ngOnInit","ionViewWillEnter","initialize","searchQuery","initializeItems","loading","create","message","present","get","then","val","undefined","idCurso","logout","usuario","JSON","parse","consultarNotificaciones","Mensaje","AuthorizationToken","subscribe","data","parseJson","error","console","log","dismiss","Error","jsonArray","items","allitems","length","i","jsonObject","push","getItems","ev","target","value","trim","filter","item","Asunto","toLowerCase","indexOf","leerNotificacion","notificacion","setNavData","navigate","sinNotificacionesAlert","alert","header","buttons","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}